<div class="modal-header">
    <h3 ng-if="!isAoISelectionModeEnabled" class="pull-left">{{ activity.label|translate }}</h3>
    <h3 ng-if="isAoISelectionModeEnabled" class="pull-left" translate>Select Area of Interest</h3>
    <div class="pull-right">
        <button type="button"
        class="btn"
        ng-disabled="isAoISelectionModeEnabled"
        ng-click="close()"
        translate>Cancel</button>
        <button type="button"
        class="btn btn--primary"
        ng-click="done()"
        ng-disabled="!saveIsEnabled()"
        translate>Save</button>
    </div>
</div>

<div class="modal-body modal-body__flex">
    <div class="modal-body__flex-top">
        <div class="modal-body__flex-main">
            <div ng-if="!selectedRendition">
                <label ng-if="!isAoISelectionModeEnabled"class="field-label">
                    <span translate>Original</span>
                    <span class="size">
                        {{ data.item.renditions.original.width }} x {{ data.item.renditions.original.height }}
                    </span>
                </label>
                <label ng-if="isAoISelectionModeEnabled" class="field-label">
                    <span translate>New size</span>
                    <span class="size">
                        {{ areaOfInterestData.CropRight - areaOfInterestData.CropLeft }}
                        x {{ areaOfInterestData.CropBottom - areaOfInterestData.CropTop }}
                    </span>
                </label>
                <sd-image-point
                    ng-show="!isAoISelectionModeEnabled"
                    data-src="data.item.renditions.viewImage.href"
                    data-poi="data.poi"
                    data-on-change="data.isDirty = true">
                </sd-image-point>
                <div class="modal-body__flex-loader" ng-if="loaderForAoI"></div>
                <div sd-image-crop
                    data-show-min-size-error="true"
                    data-src="data.item.renditions.viewImage.href"
                    data-original="data.item.renditions.original"
                    data-crop-data="areaOfInterestData"
                    ng-if="isAoISelectionModeEnabled && !loaderForAoI">
                </div>
                <div ng-if="isAoISelectionModeEnabled && !loaderForAoI">
                    <button class="btn" ng-click="showAreaOfInterestView(false)" translate>Cancel</button>
                    <button class="btn btn--primary" ng-click="saveAreaOfInterest(areaOfInterestData)" translate>Save</button>
                </div>
                <button class="btn"
                        ng-click="showAreaOfInterestView()"
                        ng-if="data.showAoISelectionButton && !isAoISelectionModeEnabled"
                        translate>Select the area of interest</button>
            </div>
            <div class="crop-area selected" ng-if="selectedRendition">
                <label class="field-label">{{ selectedRendition.name }}</label>
                <div sd-image-crop-view
                     data-src="data.item.renditions.viewImage.href"
                     data-original="data.item.renditions.original"
                     data-crop-data="data.cropData[selectedRendition.name]"
                ></div>
            </div>
        </div>
        <div class="modal-body__flex-sidebar modal-body__flex-metadata"
             ng-class="{'modal-body__flex--disabled': isAoISelectionModeEnabled}"
             ng-if="data.showMetadataEditor">
            <div class="header" translate>Metadata</div>
            <div>
                <label ng-class="{'label-asterisk':(data.requiredFields.indexOf('headline') > -1)}" translate>Title</label>
                <div ng-model="data.metadata.headline" ng-change="data.isDirty = true" contenteditable="true" class="contenteditable-input"></div>
            </div>
            <div>
                <label ng-class="{'label-asterisk':(data.requiredFields.indexOf('description_text') > -1)}" translate>Description</label>
                <div ng-model="data.metadata.description_text" ng-change="data.isDirty = true" contenteditable="true" class="contenteditable-input"></div>
            </div>
            <div>
                <label ng-class="{'label-asterisk':(data.requiredFields.indexOf('alt_text') > -1)}" translate>Alt Text</label>
                <div ng-model="data.metadata.alt_text" ng-change="data.isDirty = true" contenteditable="true" class="contenteditable-input"></div>
            </div>
            <div>
                <label ng-class="{'label-asterisk':(data.requiredFields.indexOf('byline') > -1)}" translate>Credit</label>
                <div ng-model="data.metadata.byline" ng-change="data.isDirty = true" contenteditable="true" class="contenteditable-input"></div>
            </div>
            <div>
                <label ng-class="{'label-asterisk':(data.requiredFields.indexOf('copyrightholder') > -1)}" translate>Copyright holder</label>
                <div ng-model="data.metadata.copyrightholder" ng-change="data.isDirty = true" contenteditable="true" class="contenteditable-input"></div>
            </div>
            <div>
                <label><span translate>Assign Rights</span></label>
                <select ng-model="data.metadata.usageterms" ng-change="data.isDirty = true">
                    <option translate value="">--- Not selected ---</option> <!-- not selected / blank option -->
                    <option translate value="single-usage">Single Usage</option>
                    <option translate value="time-restricted">Time Restricted</option>
                    <option translate value="indefinite-usage">Indefinite Usage</option>
                </select>
            </div>
            <div>
                <label ng-class="{'label-asterisk':(data.requiredFields.indexOf('copyrightnotice') > -1)}" translate>Copyright notice</label>
                <div ng-model="data.metadata.copyrightnotice" ng-change="data.isDirty = true" contenteditable="true" class="contenteditable-input"></div>
            </div>
        </div>
    </div><!-- end flex top -->

    <div class="modal-body__flex-bottom" ng-class="{'modal-body__flex--disabled': isAoISelectionModeEnabled}">
        <div class="crop-area__thumbnails">
            <ul>
                <li ng-click="selectRendition()" ng-class="{active: selectedRendition === null}">
                    <sd-image-point
                        data-src="data.item.renditions.viewImage.href"
                        data-poi="data.poi"
                        data-on-change="data.isDirty = true">
                    </sd-image-point>
                    <label class="field-label" translate>Original</label>
                </li>
                <li ng-repeat="rendition in data.renditions track by rendition.name" ng-click="selectRendition(rendition)" ng-class="{active: rendition === selectedRendition}">
                    <div sd-image-crop
                        data-show-Min-Size-Error="true"
                        data-src="data.item.renditions.viewImage.href"
                        data-original="data.item.renditions.original"
                        data-rendition="rendition"
                        data-crop-init="data.item.renditions[rendition.name]"
                        data-crop-data="data.cropData[rendition.name]"
                        data-on-change="onChange(renditionName, cropData)">
                    </div>
                    <label class="field-label">{{ rendition.name }}</label>
                </li>
            </ul>
        </div>
    </div><!-- end flex bottom -->

</div>
