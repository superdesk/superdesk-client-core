<ul class="nav nav-tabs">
    <li ng-class="{active: tab === 'metadata' || !tab}">
        <button ng-click="tab = 'metadata'" translate>Metadata</button>
    </li>

    <!-- can't use ng-if due to https://stackoverflow.com/q/36357640/1175593 -->
    <li ng-show="isAssigned(item)" ng-class="{active: tab === 'assignment'}">
        <button ng-click="tab = 'assignment'" translate>Assignment</button>
    </li>
</ul>
<div ng-controller="MetadataWidgetCtrl">
    <div class="widget-content-padding" ng-if="tab === 'metadata' || !tab">
        <ul class="basic-list basic-list--dotted">
            <li class="basic-list__item" ng-if="_isInProductionStates">
                <label class="basic-list__item-label" ng-if="_editable" translate>Not For Publication</label>
                <span class="basic-list__item-data" ng-if="_editable">
                    <span ng-if="_editable" sd-switch ng-model="item.flags.marked_for_not_publication"></span>
                </span>
                <span ng-if="!_editable">
                    <span class="state-label not-for-publication" ng-show="item.flags.marked_for_not_publication" translate>Not For Publication</span>
                    <span class="state-label for-publication" ng-show="!item.flags.marked_for_not_publication" translate>For Publication</span>
                </span>
            </li>

            <li class="basic-list__item" ng-if="_isInProductionStates">
                <label class="basic-list__item-label" ng-if="_editable" translate>Legal</label>
                <span class="basic-list__item-data" ng-if="_editable">
                    <span sd-switch ng-model="item.flags.marked_for_legal"></span>
                </span>
                <span ng-if="!_editable">
                    <span class="state-label legal" ng-show="item.flags.marked_for_legal" translate>Legal</span>
                </span>
            </li>
            <li class="basic-list__item" ng-if="!isRemovedField('usageterms')">
                <label class="basic-list__item-label" translate>Usage terms</label>
                <div class="basic-list__item-data">
                    <input class="basic-input" type="text" ng-model="item.usageterms" ng-disabled="!_editable" ng-change="autosave(item)">
                </div>
            </li>
            <li class="basic-list__item basic-list__item--stacked" ng-if="$root.config.features.alchemy">
                <label translate>Tags</label>
                <div sd-meta-tags data-item="item" data-field="keywords" data-source-field="body_html" data-change="autosave(item)" data-disabled="!_editable">
            </li>
            <li class="basic-list__item" ng-if="!isRemovedField('language')">
                <label class="basic-list__item-label" translate>Language</label>
                <div class="basic-list__item-data">
                    <input class="basic-input" type="text" ng-model="item.language" ng-disabled="!_editable" ng-change="autosave(item)">
                </div>
            </li>

            <li class="basic-list__item" ng-if="item.pubstatus">
                <label class="basic-list__item-label" translate>Pubstatus</label>
                <div class="basic-list__item-data">
                    {{item.pubstatus}}
                </div>
            </li>
            <li class="basic-list__item" ng-if="item.original_source">
                <label class="basic-list__item-label" translate>Original source</label>
                <div class="basic-list__item-data">
                    {{item.original_source}}
                </div>
            </li>
            <li class="basic-list__item" ng-if="item.copyrightholder">
                <label class="basic-list__item-label" translate>Copyright</label>
                <div class="basic-list__item-data">
                    {{item.copyrightholder}}
                </div>
            </li>
            <li class="basic-list__item" ng-if="item.copyrightnotice">
                <label class="basic-list__item-label" translate>Copyright notice</label>
                <div class="basic-list__item-data">
                    {{item.copyrightnotice}}
                </div>
            </li>
            <li class="basic-list__item" ng-if="item.creditline">
                <label class="basic-list__item-label" translate>Credit</label>
                <div class="basic-list__item-data">
                    {{item.creditline}}
                </div>
            </li>
            <li class="basic-list__item">
                <label class="basic-list__item-label" translate>State</label>
                <div class="basic-list__item-data">
                    <span sd-item-state data-state=item.state data-embargo=item.embargo></span>
                    <span ng-if="item.flags.marked_for_not_publication" class="state-label not-for-publication" translate>Not For Publication</span>
                    <span ng-if="item.flags.marked_for_legal" class="state-label legal" translate>Legal</span>
                    <span ng-if="item.flags.marked_for_sms" class="state-label sms" translate>Sms</span>
                    <span ng-if="item.rewritten_by" class="state-label updated" translate>Updated</span>
                </div>
            </li>

            <li class="basic-list__item" ng-if="item.ingest_provider">
                <label class="basic-list__item-label" translate>Ingest Provider</label>
                <div class="basic-list__item-data" sd-meta-ingest data-item="item"></div>
            </li>

            <li class="basic-list__item" ng-if="item.ingest_provider_sequence">
                <label class="basic-list__item-label" translate>Provider sequence</label>
                <div class="basic-list__item-data">
                    {{item.ingest_provider_sequence}}
                </div>
            </li>
            <li class="basic-list__item" ng-if="item.expiry">
                <label class="basic-list__item-label" translate>Expiry</label>
                <div class="basic-list__item-data" sd-reldate-complex datetime="item.expiry"></div>
            </li>

            <li class="basic-list__item" ng-if="item.slugline">
                <label class="basic-list__item-label" translate>Slugline</label>
                <div class="basic-list__item-data">
                    {{item.slugline}}
                </div>
            </li>

            <li class="basic-list__item" ng-if="item.urgency">
                <label class="basic-list__item-label" translate>Urgency</label>
                <div class="basic-list__item-data">
                    {{item.urgency}}
                </div>
            </li>

            <li class="basic-list__item" ng-if="item.priority">
                <label class="basic-list__item-label" translate>Priority</label>
                <div class="basic-list__item-data">
                    {{item.priority}}
                </div>
            </li>

            <li class="basic-list__item">
                <label class="basic-list__item-label" translate>Word Count</label>
                <div class="basic-list__item-data">
                    {{item.word_count}}
                </div>
            </li>

            <li class="basic-list__item" ng-if="item.keywords && item.keywords.length">
                <label class="basic-list__item-label" translate>Keywords</label>
                <div class="basic-list__item-data">
                        {{item.keywords | mergeWords}}
                </div>
            </li>

            <li class="basic-list__item" ng-if="item.source">
                <label class="basic-list__item-label" translate>Source</label>
                <div class="basic-list__item-data">
                        {{item.source}}
                </div>
            </li>

            <li class="basic-list__item">
                <label class="basic-list__item-label" translate>Take key</label>
                <div class="basic-list__item-data">
                        {{item.anpa_take_key}}
                </div>
            </li>

            <li class="basic-list__item" ng-if="item.signal">
                <label class="basic-list__item-label" translate>Signal</label>
                <div class="basic-list__item-data">
                        {{item.signal}}
                </div>
            </li>

            <li class="basic-list__item" ng-if="item.anpa_category && item.anpa_category.length">
                <label class="basic-list__item-label" translate>Service</label>
                <div class="basic-list__item-data">
                        {{item.anpa_category | mergeWords:'name'}}
                </div>
            </li>

            <li class="basic-list__item" ng-repeat="cv in cvs track by cv._id" ng-if="item[cv.schema_field] | mergeWords:'name' : cv._id">
                <label class="basic-list__item-label">{{ cv.display_name | translate }}</label>
                <div class="basic-list__item-data">
                        {{getLocaleName(item[cv.schema_field], cv._id)}}
                </div>
            </li>

            <li class="basic-list__item" ng-if="item.genre  && item.genre.length > 0 && !genreInCvs">
                <label class="basic-list__item-label" translate>Genre</label>
                <div class="basic-list__item-data">
                        {{item.genre | mergeWords:'name'}}
                </div>
            </li>

            <li class="basic-list__item" ng-if="item.place && item.place.length > 0 && !placeInCvs">
                <label class="basic-list__item-label" translate>Place</label>
                <div class="basic-list__item-data">
                        {{item.place | mergeWords:'name'}}
                </div>
            </li>

            <li class="basic-list__item" ng-if="item.ednote">
                <label class="basic-list__item-label" translate>Editorial Note</label>
                <div class="basic-list__item-data">
                        {{item.ednote}}
                </div>
            </li>

            <li class="basic-list__item">
                <label class="basic-list__item-label" translate>Dateline</label>
                <div class="basic-list__item-data">
                        {{item.dateline.text}}
                </div>
            </li>

            <li class="basic-list__item">
                <label class="basic-list__item-label" translate>Byline</label>
                <div class="basic-list__item-data">
                        {{item.byline}}
                </div>
            </li>

            <li class="basic-list__item">
                    <label class="basic-list__item-label" translate>Sign-Off</label>
                <div class="basic-list__item-data">
                        {{item.sign_off}}
                </div>
            </li>

            <li class="basic-list__item" ng-if="item._current_version">
                    <label class="basic-list__item-label" translate>Version</label>
                <div class="basic-list__item-data">
                        {{item._current_version}}
                </div>
            </li>

            <li class="basic-list__item" ng-if="item.firstcreated">
                    <label class="basic-list__item-label" translate>Created</label>
                <div class="basic-list__item-data" sd-reldate-complex datetime="item.firstcreated">
                </div>
            </li>

            <li class="basic-list__item" ng-if="item.versioncreated">
                    <label class="basic-list__item-label" translate>Last updated</label>
                <div class="basic-list__item-data" sd-reldate-complex datetime="item.versioncreated">
                </div>
            </li>

            <li class="basic-list__item" ng-if="item.original_id">
                    <label class="basic-list__item-label" translate>Original ID</label>
                <div class="basic-list__item-data">
                        {{item.original_id}}
                </div>
            </li>

            <li class="basic-list__item" ng-if="originalCreator">
                    <label class="basic-list__item-label" translate>Original creator</label>
                <div class="basic-list__item-data">
                        {{originalCreator}}
                </div>
            </li>

            <li class="basic-list__item" ng-if="versionCreator">
                    <label class="basic-list__item-label" translate>Version creator</label>
                <div class="basic-list__item-data">
                        {{versionCreator}}
                </div>
            </li>

            <li class="basic-list__item basic-list__item--stacked">
                <label class="basic-list__item-label basic-list__item-label--block" translate>GUID</label>
                <div class="basic-list__item-data" id="guid">
                    {{item.guid}}
                </div>
            </li>
            <li class="basic-list__item">
                <label class="basic-list__item-label" translate>Unique name</label>
                <div class="basic-list__item-data">
                    <input class="basic-input" type="text" ng-model="item.unique_name" ng-change="autosave(item)" ng-disabled="!_editable || !unique_name_editable">
                </div>
            </li>

            <li class="basic-list__item">
                    <label class="basic-list__item-label" translate>Type</label>
                <div class="basic-list__item-data">
                        {{item.type}}
                </div>
            </li>

            <li class="basic-list__item" ng-if="item.renditions && item.renditions.original">
                <label class="basic-list__item-label" translate>Dimensions</label>
                <div class="basic-list__item-data">
                    {{ item.renditions.original.width }} x {{ item.renditions.original.height }}
                </div>
            </li>

            <li class="basic-list__item" ng-if="item.type == 'picture' && item.archive_description && item.archive_description !== item.description_text">
                <label class="basic-list__item-label" translate>Description</label>
                <div class="basic-list__item-data" sd-html-preview="item.archive_description"></div>
            </li>
        </ul>
    </div>
    <div ng-if="tab === 'assignment'" sd-assignment-preview data-item="item" hide-avatar="true"></div>
</div>