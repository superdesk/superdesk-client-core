<div class="modal-header">
    <h3 class="pull-left">{{ activity.label|translate }}</h3>
    <button type="button" class="close" ng-click="close()"><i class="icon-close-small"></i></button>
</div>

<div class="modal-body">
    <section class="main">
        <div class="change-image__metadata" ng-if="data.showMetadataEditor">
            <div class="change-image__metadata__header">Metadata</div>
            <div>
                <input type="text" placeholder="Add a headline *" ng-model="data.metadata.headline" ng-change="data.isDirty = true">
            </div>
            <div>
                <input type="text" placeholder="Add a description *" ng-model="data.metadata.description_text" ng-change="data.isDirty = true">
            </div>
            <div>
                <input type="text" placeholder="Add a slugline *" ng-model="data.metadata.slugline" ng-change="data.isDirty = true">
            </div>
            <div>
                <input type="text" placeholder="Add author / photographer" ng-model="data.metadata.byline" ng-change="data.isDirty = true">
            </div>
        </div>
        <div id="dynBoxId2" class="preview">
            <div class="selected-area">
                <label class="field-label" translate>Selected</label>
                <div class="crop-area selected" ng-if="selectedRendition">
                    <div sd-image-crop
                        data-show-Min-Size-Error="true"
                        data-box-width="1200"
                        data-box-height="800"
                        data-src="data.item.renditions.viewImage.href"
                        data-original="data.item.renditions.original"
                        data-rendition="selectedRendition"
                        data-crop-init="data.item.renditions[selectedRendition.name]"
                        data-crop-data="data.cropData[selectedRendition.name]"
                        data-on-change="data.isDirty = true">
                    </div>
                </div>
                <div ng-if="!selectedRendition">
                    <div sd-image-point
                        data-src="data.item.renditions.viewImage.href"
                        data-point="data.poi"
                        data-on-change="data.isDirty = true">
                    </div>
                </div>
            </div>
            <div class="original">
                <div class="crop-area thumbnails">
                    <ul>
                        <li ng-click="selectRendition()" ng-class="{active: selectedRendition === null}">                        
                            <img src="{{data.item.renditions.viewImage.href}}">
                            <label class="field-label" translate>Original</label>
                        </li>
                        <li ng-repeat="rendition in data.renditions track by rendition.name" ng-click="selectRendition(rendition)" ng-class="{active: rendition === selectedRendition}">                         
                            <div sd-image-crop
                                data-show-Min-Size-Error="true"
                                data-box-width="600"
                                data-box-height="400"
                                data-src="data.item.renditions.viewImage.href"
                                data-original="data.item.renditions.original"
                                data-rendition="rendition"
                                data-crop-init="data.item.renditions[rendition.name]"
                                data-crop-data="data.cropData[rendition.name]"
                                data-on-change="data.isDirty = true">
                            </div>

                            <fieldset
                                ng-if="data.renditions.length === 1 && data.cropData[rendition.name]">
                                <br>
                                <label for="max-width-input" translate>Max width</label>
                                <input type="number"
                                    id="max-width-input"
                                    class="input-small"
                                    ng-model="data.cropData[rendition.name].width"
                                    min="1"
                                    placeholder="{{ data.cropData[rendition.name].CropRight - data.cropData[rendition.name].CropLeft }}">
                                <label for="max-height-input" translate>Max height</label>
                                <input type="number"
                                    id="max-height-input"
                                    class="input-small"
                                    ng-model="data.cropData[rendition.name].height"
                                    min="1"
                                    placeholder="{{ data.cropData[rendition.name].CropBottom - data.cropData[rendition.name].CropTop }}">
                            </fieldset>                        
                            <label class="field-label" ng-if="data.renditions.length > 1">{{ rendition.name }}</label>
                        </li>
                    </ul>
                </div>
          </div>
        </div>
    </section>
</div>

<div class="modal-footer">
    <button type="button"
        class="btn btn-medium btn-info"
        ng-click="done()"
        ng-disabled="!data.isDirty"
        translate>Save</button>
</div>
